-- Gojo Infinity Script for Roblox
-- T·∫°o hi·ªáu ·ª©ng "V√¥ H·∫°n" - l√†m ch·∫≠m v√† ƒë·∫©y l√πi k·∫ª ƒë·ªãch khi ti·∫øn g·∫ßn

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")
local rootPart = character:WaitForChild("HumanoidRootPart")

-- C·∫•u h√¨nh Infinity
local INFINITY_ENABLED = false
local INFINITY_RADIUS = 20 -- B√°n k√≠nh hi·ªáu ·ª©ng
local SLOW_FACTOR = 0.1 -- ƒê·ªô ch·∫≠m (0.1 = 10% t·ªëc ƒë·ªô g·ªëc)
local REPEL_FORCE = 50 -- L·ª±c ƒë·∫©y l√πi
local EFFECT_UPDATE_RATE = 0.1 -- T·∫ßn su·∫•t c·∫≠p nh·∫≠t hi·ªáu ·ª©ng

-- L∆∞u tr·ªØ t·ªëc ƒë·ªô g·ªëc c·ªßa c√°c ƒë·ªëi t∆∞·ª£ng
local originalSpeeds = {}
local affectedPlayers = {}

-- T·∫°o hi·ªáu ·ª©ng visual
local function createInfinityEffect()
    local effect = Instance.new("Part")
    effect.Name = "InfinityField"
    effect.Anchored = true
    effect.CanCollide = false
    effect.Shape = Enum.PartType.Ball
    effect.Material = Enum.Material.ForceField
    effect.BrickColor = BrickColor.new("Bright blue")
    effect.Transparency = 0.7
    effect.Size = Vector3.new(INFINITY_RADIUS * 2, INFINITY_RADIUS * 2, INFINITY_RADIUS * 2)
    effect.CFrame = rootPart.CFrame
    effect.Parent = workspace
    
    -- Animation xoay
    local rotationTween = TweenService:Create(
        effect, 
        TweenInfo.new(2, Enum.EasingStyle.Linear, Enum.EasingDirection.InOut, -1),
        {CFrame = effect.CFrame * CFrame.Angles(0, math.rad(360), 0)}
    )
    rotationTween:Play()
    
    return effect
end

-- T·∫°o hi·ªáu ·ª©ng particles
local function createParticleEffect()
    local attachment = Instance.new("Attachment")
    attachment.Parent = rootPart
    
    local particles = Instance.new("ParticleEmitter")
    particles.Parent = attachment
    particles.Texture = "rbxasset://textures/particles/sparkles_main.dds"
    particles.Color = ColorSequence.new(Color3.fromRGB(0, 162, 255))
    particles.Size = NumberSequence.new{
        NumberSequenceKeypoint.new(0, 0.5),
        NumberSequenceKeypoint.new(1, 0)
    }
    particles.Lifetime = NumberRange.new(1, 2)
    particles.Rate = 50
    particles.SpreadAngle = Vector2.new(360, 360)
    particles.Speed = NumberRange.new(5, 10)
    
    return particles
end

-- √Åp d·ª•ng hi·ªáu ·ª©ng infinity l√™n m·ªôt ng∆∞·ªùi ch∆°i
local function applyInfinityEffect(targetPlayer)
    if not targetPlayer.Character or targetPlayer == player then return end
    
    local targetRoot = targetPlayer.Character:FindFirstChild("HumanoidRootPart")
    local targetHumanoid = targetPlayer.Character:FindFirstChild("Humanoid")
    
    if not targetRoot or not targetHumanoid then return end
    
    local distance = (targetRoot.Position - rootPart.Position).Magnitude
    
    if distance <= INFINITY_RADIUS then
        -- L∆∞u t·ªëc ƒë·ªô g·ªëc
        if not originalSpeeds[targetPlayer] then
            originalSpeeds[targetPlayer] = targetHumanoid.WalkSpeed
        end
        
        -- T√≠nh to√°n hi·ªáu ·ª©ng d·ª±a tr√™n kho·∫£ng c√°ch
        local effectStrength = 1 - (distance / INFINITY_RADIUS)
        local slowedSpeed = originalSpeeds[targetPlayer] * (SLOW_FACTOR + (1 - SLOW_FACTOR) * (1 - effectStrength))
        
        -- √Åp d·ª•ng t·ªëc ƒë·ªô ch·∫≠m
        targetHumanoid.WalkSpeed = slowedSpeed
        
        -- T·∫°o l·ª±c ƒë·∫©y l√πi (ngh·ªãch l√Ω Zeno)
        local direction = (targetRoot.Position - rootPart.Position).Unit
        local repelForce = direction * REPEL_FORCE * effectStrength
        
        -- T·∫°o BodyVelocity ƒë·ªÉ ƒë·∫©y l√πi
        local bodyVelocity = targetRoot:FindFirstChild("InfinityRepel")
        if not bodyVelocity then
            bodyVelocity = Instance.new("BodyVelocity")
            bodyVelocity.Name = "InfinityRepel"
            bodyVelocity.MaxForce = Vector3.new(4000, 0, 4000)
            bodyVelocity.Parent = targetRoot
        end
        
        bodyVelocity.Velocity = repelForce
        
        -- ƒê√°nh d·∫•u ng∆∞·ªùi ch∆°i b·ªã ·∫£nh h∆∞·ªüng
        affectedPlayers[targetPlayer] = true
        
        -- T·∫°o hi·ªáu ·ª©ng visual tr√™n m·ª•c ti√™u
        local targetEffect = targetRoot:FindFirstChild("InfinityTarget")
        if not targetEffect then
            targetEffect = Instance.new("SelectionBox")
            targetEffect.Name = "InfinityTarget"
            targetEffect.Color3 = Color3.fromRGB(0, 162, 255)
            targetEffect.Transparency = 0.5
            targetEffect.Adornee = targetRoot
            targetEffect.Parent = targetRoot
        end
    else
        -- Lo·∫°i b·ªè hi·ªáu ·ª©ng khi ra ngo√†i ph·∫°m vi
        removeInfinityEffect(targetPlayer)
    end
end

-- Lo·∫°i b·ªè hi·ªáu ·ª©ng infinity kh·ªèi m·ªôt ng∆∞·ªùi ch∆°i
local function removeInfinityEffect(targetPlayer)
    if not targetPlayer.Character then return end
    
    local targetRoot = targetPlayer.Character:FindFirstChild("HumanoidRootPart")
    local targetHumanoid = targetPlayer.Character:FindFirstChild("Humanoid")
    
    if targetHumanoid and originalSpeeds[targetPlayer] then
        targetHumanoid.WalkSpeed = originalSpeeds[targetPlayer]
    end
    
    if targetRoot then
        -- Lo·∫°i b·ªè l·ª±c ƒë·∫©y
        local bodyVelocity = targetRoot:FindFirstChild("InfinityRepel")
        if bodyVelocity then
            bodyVelocity:Destroy()
        end
        
        -- Lo·∫°i b·ªè hi·ªáu ·ª©ng visual
        local targetEffect = targetRoot:FindFirstChild("InfinityTarget")
        if targetEffect then
            targetEffect:Destroy()
        end
    end
    
    originalSpeeds[targetPlayer] = nil
    affectedPlayers[targetPlayer] = nil
end

-- B·∫≠t/t·∫Øt Infinity
local function toggleInfinity()
    INFINITY_ENABLED = not INFINITY_ENABLED
    
    if INFINITY_ENABLED then
        print("üîµ Gojo Infinity: ACTIVATED")
        
        -- T·∫°o hi·ªáu ·ª©ng
        local infinityField = createInfinityEffect()
        local particles = createParticleEffect()
        
        -- V√≤ng l·∫∑p c·∫≠p nh·∫≠t hi·ªáu ·ª©ng
        local connection
        connection = RunService.Heartbeat:Connect(function()
            if not INFINITY_ENABLED then
                connection:Disconnect()
                infinityField:Destroy()
                particles:Destroy()
                
                -- Lo·∫°i b·ªè hi·ªáu ·ª©ng kh·ªèi t·∫•t c·∫£ ng∆∞·ªùi ch∆°i
                for targetPlayer, _ in pairs(affectedPlayers) do
                    removeInfinityEffect(targetPlayer)
                end
                return
            end
            
            -- C·∫≠p nh·∫≠t v·ªã tr√≠ hi·ªáu ·ª©ng
            infinityField.CFrame = rootPart.CFrame
            
            -- √Åp d·ª•ng hi·ªáu ·ª©ng l√™n t·∫•t c·∫£ ng∆∞·ªùi ch∆°i kh√°c
            for _, targetPlayer in pairs(Players:GetPlayers()) do
                if targetPlayer ~= player then
                    applyInfinityEffect(targetPlayer)
                end
            end
        end)
        
    else
        print("‚ö™ Gojo Infinity: DEACTIVATED")
    end
end

-- T·∫°o GUI cho mobile
local function createMobileGUI()
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "GojoInfinityGUI"
    screenGui.Parent = player:WaitForChild("PlayerGui")
    
    -- Main Frame
    local mainFrame = Instance.new("Frame")
    mainFrame.Size = UDim2.new(0, 200, 0, 100)
    mainFrame.Position = UDim2.new(0, 10, 0, 10)
    mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    mainFrame.BorderSizePixel = 0
    mainFrame.Parent = screenGui
    
    -- Corner
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 10)
    corner.Parent = mainFrame
    
    -- Title
    local title = Instance.new("TextLabel")
    title.Size = UDim2.new(1, 0, 0, 30)
    title.Position = UDim2.new(0, 0, 0, 0)
    title.BackgroundTransparency = 1
    title.Text = "üîµ GOJO INFINITY"
    title.TextColor3 = Color3.fromRGB(0, 162, 255)
    title.TextScaled = true
    title.Font = Enum.Font.GothamBold
    title.Parent = mainFrame
    
    -- Toggle Button
    local toggleButton = Instance.new("TextButton")
    toggleButton.Size = UDim2.new(0.8, 0, 0, 40)
    toggleButton.Position = UDim2.new(0.1, 0, 0, 50)
    toggleButton.BackgroundColor3 = Color3.fromRGB(255, 70, 70)
    toggleButton.Text = "‚ùå DEACTIVATED"
    toggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    toggleButton.TextScaled = true
    toggleButton.Font = Enum.Font.GothamBold
    toggleButton.Parent = mainFrame
    
    local buttonCorner = Instance.new("UICorner")
    buttonCorner.CornerRadius = UDim.new(0, 8)
    buttonCorner.Parent = toggleButton
    
    -- Button click event
    toggleButton.MouseButton1Click:Connect(function()
        toggleInfinity()
        if INFINITY_ENABLED then
            toggleButton.BackgroundColor3 = Color3.fromRGB(70, 255, 70)
            toggleButton.Text = "‚úÖ ACTIVATED"
        else
            toggleButton.BackgroundColor3 = Color3.fromRGB(255, 70, 70)
            toggleButton.Text = "‚ùå DEACTIVATED"
        end
    end)
    
    -- Status Label
    local statusLabel = Instance.new("TextLabel")
    statusLabel.Size = UDim2.new(1, 0, 0, 20)
    statusLabel.Position = UDim2.new(0, 0, 1, 5)
    statusLabel.BackgroundTransparency = 1
    statusLabel.Text = "Tap button or type /infinity"
    statusLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
    statusLabel.TextScaled = true
    statusLabel.Font = Enum.Font.Gotham
    statusLabel.Parent = mainFrame
    
    return screenGui
end

-- T·∫°o GUI
local mobileGUI = createMobileGUI()

-- V·∫´n h·ªó tr·ª£ ph√≠m b·∫•m cho PC
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    
    if input.KeyCode == Enum.KeyCode.X then
        toggleInfinity()
        -- C·∫≠p nh·∫≠t GUI n·∫øu c√≥
        local gui = player.PlayerGui:FindFirstChild("GojoInfinityGUI")
        if gui then
            local button = gui:FindFirstChild("Frame"):FindFirstChild("TextButton")
            if INFINITY_ENABLED then
                button.BackgroundColor3 = Color3.fromRGB(70, 255, 70)
                button.Text = "‚úÖ ACTIVATED"
            else
                button.BackgroundColor3 = Color3.fromRGB(255, 70, 70)
                button.Text = "‚ùå DEACTIVATED"
            end
        end
    end
end)

-- Chat commands
player.Chatted:Connect(function(message)
    local lowerMessage = string.lower(message)
    
    if lowerMessage == "/infinity" or lowerMessage == "/gojo" then
        toggleInfinity()
    elseif lowerMessage == "/help" or lowerMessage == "/commands" then
        print("üîµ Gojo Infinity Commands:")
        print("- Press X or type /infinity to toggle Infinity")
        print("- Type /help for this message")
        print("- Infinity radius: " .. INFINITY_RADIUS .. " studs")
    end
end)

print("üîµ Gojo Infinity Script Loaded!")
print("üìã Controls:")
print("- Press X to toggle Infinity")
print("- Type /infinity or /gojo to toggle")
print("- Type /help for commands")

-- X·ª≠ l√Ω khi character respawn
player.CharacterAdded:Connect(function(newCharacter)
    character = newCharacter
    humanoid = character:WaitForChild("Humanoid")
    rootPart = character:WaitForChild("HumanoidRootPart")
    INFINITY_ENABLED = false
    originalSpeeds = {}
    affectedPlayers = {}
end)
